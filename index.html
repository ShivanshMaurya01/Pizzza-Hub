<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UrbanSlice Ultimate | RIX Edition</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Roboto, sans-serif; }
        body { background: #0f0f0f; color: white; overflow-x: hidden; transition: background 0.5s; }

        /* SPLASH SCREEN */
        #splashScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #111; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.8s; }
        #splashScreen h1 { font-size: 50px; color: #ffcc00; margin-bottom: 20px; text-align: center; }
        #splashScreen p { font-size: 18px; color: #aaa; font-style: italic; }

        /* AUTH UI */
        .hidden { display: none !important; }
        button { cursor: pointer; border: none; padding: 12px 20px; border-radius: 6px; font-weight: bold; transition: 0.3s; }
        button:hover { opacity: 0.8; transform: scale(1.02); }
        
        .auth-container { height: 100vh; display: flex; justify-content: center; align-items: center; background: linear-gradient(135deg, #111, #1c1c1c); }
        .auth-box { background: #1a1a1a; padding: 40px; width: 380px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.7); border: 1px solid #333; }
        .auth-box h2 { text-align: center; margin-bottom: 25px; color: #ffcc00; letter-spacing: 1px; }
        .auth-box input { width: 100%; padding: 12px; margin-bottom: 15px; background: #0a0a0a; border: 1px solid #444; color: white; border-radius: 5px; }
        .auth-box button { width: 100%; background: #ffcc00; color: black; font-size: 16px; }
        .auth-box p { margin-top: 15px; text-align: center; font-size: 13px; cursor: pointer; color: #888; text-decoration: underline; }

        /* NAV & APP */
        nav { background: rgba(17, 17, 17, 0.95); padding: 15px 8%; display: flex; justify-content: space-between; align-items: center; position: fixed; width: 100%; z-index: 1000; border-bottom: 1px solid #333; }
        nav h1 { color: #ffcc00; font-size: 22px; }
        nav ul { list-style: none; display: flex; gap: 25px; align-items: center; }
        nav ul li { cursor: pointer; color: #eee; font-size: 14px; text-transform: uppercase; font-weight: 600; }
        nav ul li:hover { color: #ffcc00; }

        #app { padding-top: 70px; }
        .hero { height: 50vh; background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1513104890138-7c749659a591?auto=format&fit=crop&w=1200') center/cover; display: flex; justify-content: center; align-items: center; text-align: center; }
        .hero-box h2 { font-size: 48px; color: #ffcc00; text-shadow: 2px 2px 10px rgba(0,0,0,1); }

        /* MENU */
        section { padding: 50px 8%; }
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; }
        .card { background: #1a1a1a; border-radius: 12px; overflow: hidden; transition: 0.4s; border: 1px solid #222; }
        .card:hover { transform: translateY(-10px); border-color: #ffcc00; box-shadow: 0 10px 20px rgba(255, 204, 0, 0.1); }
        .card img { width: 100%; height: 220px; object-fit: cover; }
        .card-content { padding: 20px; }
        .card-content h3 { font-size: 20px; margin-bottom: 8px; }
        .price-tag { color: #ffcc00; font-size: 18px; font-weight: bold; display: block; margin-bottom: 15px; }
        .card button { width: 100%; background: #333; color: white; border: 1px solid #ffcc00; }
        .card button:hover { background: #ffcc00; color: black; }

        /* CART PANEL */
        .cart-panel { position: fixed; right: -400px; top: 0; width: 380px; height: 100%; background: #111; padding: 30px; transition: 0.5s ease-in-out; z-index: 2000; box-shadow: -5px 0 20px rgba(0,0,0,0.8); }
        .cart-panel.active { right: 0; }
        .cart-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #222; align-items: center; }
        .cart-item button { padding: 5px 10px; background: #ff4444; font-size: 12px; }
        .cart-total { margin: 25px 0; font-size: 22px; text-align: right; color: #ffcc00; }

        /* TRACKING */
        #trackingScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 4000; }
        .progress-bar { width: 300px; height: 10px; background: #333; border-radius: 10px; margin: 20px 0; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: #ffcc00; transition: 0.5s; }

        /* ADMIN */
        #adminDashboard { background: #0a0a0a; min-height: 100vh; padding: 40px 8%; position: fixed; top: 0; left: 0; width: 100%; z-index: 5000; overflow-y: auto; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
        .stat-card { background: #1a1a1a; padding: 25px; border-radius: 10px; text-align: center; border: 1px solid #333; }
        .stat-card h3 { font-size: 14px; color: #888; text-transform: uppercase; margin-bottom: 10px; }
        .stat-card p { font-size: 32px; font-weight: bold; color: #ffcc00; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #111; }
        th, td { padding: 15px; border: 1px solid #222; text-align: left; }
        th { background: #1a1a1a; color: #ffcc00; }
        canvas { background: #111; border: 1px solid #333; margin-top: 20px; width: 100% !important; height: auto !important; }
    </style>
</head>
<body>

<div id="splashScreen">
    <h1>URBANSLICE ULTIMATE</h1>
    <p>"Premium Experience for Raebareli Industrial Exchange"</p>
</div>

<div id="loginPage" class="auth-container hidden">
    <div class="auth-box">
        <h2>User Login</h2>
        <input type="text" id="loginUsername" placeholder="Enter Username">
        <input type="password" id="loginPassword" placeholder="Enter Password">
        <button onclick="login()">Login</button>
        <p onclick="showRegister()">Create an Account</p>
        <p onclick="showAdminLogin()" style="color:#ffcc00">Admin Portal</p>
    </div>
</div>

<div id="registerPage" class="auth-container hidden">
    <div class="auth-box">
        <h2>Register</h2>
        <input type="text" id="regUsername" placeholder="Choose Username">
        <input type="password" id="regPassword" placeholder="Choose Password">
        <button onclick="register()">Register Now</button>
        <p onclick="showLogin()">Back to Login</p>
    </div>
</div>

<div id="adminLoginPage" class="auth-container hidden">
    <div class="auth-box">
        <h2>Admin Access</h2>
        <input type="password" id="adminKey" placeholder="Master Password">
        <button onclick="adminLogin()">Access Dashboard</button>
        <p onclick="showLogin()">Exit</p>
    </div>
</div>

<div id="app" class="hidden">
    <nav>
        <h1>UrbanSlice <span style="color:white">RIX</span></h1>
        <ul>
            <li onclick="toggleCart()">Cart (<span id="cartCount">0</span>)</li>
            <li onclick="logout()" style="color:#ff4444">Logout</li>
        </ul>
    </nav>
    <div class="hero">
        <div class="hero-box">
            <h2>The Art of Pizza</h2>
        </div>
    </div>
    <section>
        <h2 style="margin-bottom: 30px;">Chef's Special</h2>
        <div class="menu-grid" id="menuContainer"></div>
    </section>
</div>

<div class="cart-panel" id="cartPanel">
    <div style="display:flex; justify-content: space-between; align-items: center;">
        <h2>Your Order</h2>
        <button onclick="toggleCart()" style="background:transparent; color:white; font-size:20px;">×</button>
    </div>
    <hr style="margin:20px 0; border:0; border-top:1px solid #333;">
    <div id="cartItems"></div>
    <div class="cart-total">Total: ₹<span id="cartTotal">0</span></div>
    <button onclick="checkout()" style="width:100%; background:#ffcc00; color:black;">Checkout & Pay</button>
</div>

<div id="trackingScreen" class="hidden">
    <h2 id="trackTitle">Processing...</h2>
    <div class="progress-bar"><div class="progress-fill" id="trackFill"></div></div>
    <p id="trackStatus">Connecting to Kitchen...</p>
    <button id="closeTrackBtn" class="hidden" onclick="closeTracking()" style="margin-top:20px;">Close Tracking</button>
</div>

<div id="adminDashboard" class="hidden">
    <div style="display:flex; justify-content: space-between; align-items: center;">
        <h1>RIX Sales Analytics</h1>
        <div>
            <button onclick="clearSystemData()" style="background:#ff4444; color:white; margin-right:10px;">Reset System</button>
            <button onclick="closeAdmin()" style="background:#333; color:white;">Close</button>
        </div>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card"><h3>Users</h3><p id="statUsers">0</p></div>
        <div class="stat-card"><h3>Orders</h3><p id="statOrders">0</p></div>
        <div class="stat-card"><h3>Revenue</h3><p>₹<span id="statRevenue">0</span></p></div>
    </div>

    <div style="display:grid; grid-template-columns: 2fr 1fr; gap:20px;">
        <div style="background:#111; padding:20px; border-radius:10px;">
            <h3>Order Log</h3>
            <table>
                <thead><tr><th>ID</th><th>Customer</th><th>Amount</th><th>Status</th></tr></thead>
                <tbody id="adminOrderTable"></tbody>
            </table>
        </div>
        <div style="background:#111; padding:20px; border-radius:10px;">
            <h3>Revenue Trend</h3>
            <canvas id="revChart" width="400" height="300"></canvas>
        </div>
    </div>
</div>

<script>
// --- INITIALIZATION & DATA ---
let currentUser = null;
let cart = [];
let users = JSON.parse(localStorage.getItem('rix_users')) || [];
let orders = JSON.parse(localStorage.getItem('rix_orders')) || [];

const menu = [
    { id: 101, name: "Truffle Margherita", price: 499, img: "https://images.unsplash.com/photo-1574071318508-1cdbad80ad38?w=500" },
    { id: 102, name: "Spicy Paneer Tikka", price: 399, img: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=500" },
    { id: 103, name: "Industrial Veggie Mix", price: 449, img: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=500" },
    { id: 104, name: "Cheese Overload", price: 549, img: "https://images.unsplash.com/photo-1548365328-8c6db3220e4c?w=500" }
];

// --- APP FLOW ---
window.onload = () => {
    setTimeout(() => {
        document.getElementById('splashScreen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('splashScreen').classList.add('hidden');
            showLogin();
        }, 800);
    }, 2500);
};

// --- AUTH LOGIC ---
function showLogin() { hideAll(); document.getElementById('loginPage').classList.remove('hidden'); }
function showRegister() { hideAll(); document.getElementById('registerPage').classList.remove('hidden'); }
function showAdminLogin() { hideAll(); document.getElementById('adminLoginPage').classList.remove('hidden'); }
function hideAll() { 
    ['loginPage', 'registerPage', 'adminLoginPage', 'app', 'adminDashboard', 'trackingScreen']
    .forEach(id => document.getElementById(id).classList.add('hidden')); 
}

function register() {
    let u = document.getElementById('regUsername').value;
    let p = document.getElementById('regPassword').value;
    if(!u || !p) return alert("Fill all fields");
    if(users.find(user => user.username === u)) return alert("User exists!");
    users.push({ username: u, password: p });
    localStorage.setItem('rix_users', JSON.stringify(users));
    alert("Registration Successful!");
    showLogin();
}

function login() {
    let u = document.getElementById('loginUsername').value;
    let p = document.getElementById('loginPassword').value;
    let user = users.find(user => user.username === u && user.password === p);
    if(user) {
        currentUser = u;
        hideAll();
        document.getElementById('app').classList.remove('hidden');
        renderMenu();
    } else { alert("Invalid Credentials"); }
}

function adminLogin() {
    if(document.getElementById('adminKey').value === "admin123") {
        hideAll();
        document.getElementById('adminDashboard').classList.remove('hidden');
        updateAdminStats();
    } else { alert("Access Denied"); }
}

function logout() { currentUser = null; cart = []; showLogin(); }

// --- SHOPPING LOGIC ---
function renderMenu() {
    const container = document.getElementById('menuContainer');
    container.innerHTML = menu.map(item => `
        <div class="card">
            <img src="${item.img}">
            <div class="card-content">
                <h3>${item.name}</h3>
                <span class="price-tag">₹${item.price}</span>
                <button onclick="addToCart(${item.id})">Add to Order</button>
            </div>
        </div>
    `).join('');
}

function addToCart(id) {
    let item = menu.find(m => m.id === id);
    cart.push(item);
    updateCartUI();
}

function updateCartUI() {
    const list = document.getElementById('cartItems');
    let total = 0;
    list.innerHTML = cart.map((item, idx) => {
        total += item.price;
        return `<div class="cart-item">
                    <span>${item.name}</span>
                    <span>₹${item.price} <button onclick="removeFromCart(${idx})">×</button></span>
                </div>`;
    }).join('');
    document.getElementById('cartTotal').innerText = total;
    document.getElementById('cartCount').innerText = cart.length;
}

function removeFromCart(idx) { cart.splice(idx, 1); updateCartUI(); }
function toggleCart() { document.getElementById('cartPanel').classList.toggle('active'); }

// --- ORDERING & TRACKING ---
function checkout() {
    if(cart.length === 0) return alert("Cart is empty!");
    let amount = cart.reduce((s, i) => s + i.price, 0);
    let newOrder = {
        id: "RIX-" + Math.floor(Math.random()*9000 + 1000),
        user: currentUser,
        amount: amount,
        status: "Confirmed",
        date: new Date().toLocaleDateString()
    };
    orders.push(newOrder);
    localStorage.setItem('rix_orders', JSON.stringify(orders));
    
    toggleCart();
    startTracking(newOrder.id);
    cart = [];
    updateCartUI();
}

function startTracking(orderId) {
    document.getElementById('trackingScreen').classList.remove('hidden');
    document.getElementById('closeTrackBtn').classList.add('hidden');
    let steps = ["Chef is prepping", "In the Oven", "Quality Check", "Out for Delivery"];
    let fill = document.getElementById('trackFill');
    let status = document.getElementById('trackStatus');
    let i = 0;

    let interval = setInterval(() => {
        fill.style.width = ((i+1) * 25) + "%";
        status.innerText = steps[i];
        i++;
        if(i >= steps.length) {
            clearInterval(interval);
            status.innerText = "Enjoy your meal! Order " + orderId + " Delivered.";
            document.getElementById('closeTrackBtn').classList.remove('hidden');
        }
    }, 1500);
}

function closeTracking() { document.getElementById('trackingScreen').classList.add('hidden'); }

// --- ADMIN SYSTEM ---
function updateAdminStats() {
    document.getElementById('statUsers').innerText = users.length;
    document.getElementById('statOrders').innerText = orders.length;
    let totalRev = orders.reduce((s, o) => s + o.amount, 0);
    document.getElementById('statRevenue').innerText = totalRev;

    document.getElementById('adminOrderTable').innerHTML = orders.slice().reverse().map(o => `
        <tr><td>${o.id}</td><td>${o.user}</td><td>₹${o.amount}</td><td style="color:#ffcc00">${o.status}</td></tr>
    `).join('');
    
    drawChart();
}

function drawChart() {
    const canvas = document.getElementById('revChart');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0,0,400,300);
    ctx.strokeStyle = "#ffcc00";
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(0, 300);
    
    orders.slice(-5).forEach((o, i) => {
        let x = (i + 1) * 70;
        let y = 300 - (o.amount / 10); // Scale down for view
        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.fillStyle = "white";
        ctx.fillText("₹" + o.amount, x - 10, y - 10);
    });
}

function clearSystemData() {
    if(confirm("Wipe all user and order data?")) {
        localStorage.clear();
        location.reload();
    }
}

function closeAdmin() { showLogin(); }
</script>
</body>
</html>
